{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Earth's Freshwater & Biological Water Distribution",
  "data": { "url": "water_cleaned.csv" },
  "params": [
    {
      "name": "viewFilter",
      "value": "FreshwaterOnly",
      "bind": {
        "input": "select",
        "options": ["FreshwaterOnly", "FreshwaterAndBiological"],
        "labels": ["Freshwater Only", "Freshwater + Biological"]
      }
    },
    {
      "name": "scaleType",
      "value": "linear",
      "bind": {
        "input": "select",
        "options": ["linear", "log"],
        "labels": ["Linear Scale", "Log Scale"]
      }
    },
    {
      "name": "highlight",
      "select": {"type": "point", "fields": ["Category"]},
      "bind": "legend"
    }
  ],

  "vconcat": [
    {
      "hconcat": [
        {
          "transform": [
            {"filter": "datum.CategoryGroup === 'Fresh Water'"},
            {"filter": "scaleType === 'linear'"}
          ],
          "mark": "bar",
          "encoding": {
            "y": {"field": "Category", "type": "nominal", "sort": "-x"},
            "x": {
              "field": "Volume_km3",
              "type": "quantitative",
              "scale": {"type": "linear"},
              "title": "Volume (kmÂ³)"
            },
            "color": {"field": "CategoryGroup"},
            "opacity": {"condition": {"param": "highlight", "value": 1}, "value": 0.4}
          }
        }
      ]
    }
  ]
}
